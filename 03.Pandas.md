# Pandas in Python - Complete Study Guide

This guide covers Pandas in detail, illustrating the usage of each function with explanations and examples. It also includes an introduction to Scikit-learn and its common functions.

---

## Introduction to Pandas

**Pandas** is a Python library for data analysis and manipulation.

* Created by Wes McKinney in 2008.
* Stands for "Panel Data" and "Python Data Analysis".
* Integrates well with NumPy, Matplotlib, and Scikit-learn.

**Installation:**

```bash
pip install pandas
```

**Import:**

```python
import pandas as pd
```

---

## Reading Data

### CSV Files

```python
df = pd.read_csv('data.csv')
```

*Usage:* Loads CSV into a DataFrame. Parameters like `sep` control the delimiter.

### Excel Files

```python
df = pd.read_excel('data.xlsx')
```

*Usage:* Reads Excel into a DataFrame. Use `sheet_name` to select a sheet.

Multiple sheets:

```python
xls = pd.ExcelFile('data.xlsx')
df1 = pd.read_excel(xls, 'Sheet1')
df2 = pd.read_excel(xls, 'Sheet2')
```

### Selecting Data

```python
df.loc[0:5, ['Name', 'Salary']]  # label-based
df.iloc[0:5, 0:2]                # position-based
```

---

## Viewing Data

```python
df.head(10)      # first 10 rows
df.tail(5)       # last 5 rows
df.info()        # structure & types
df.describe()    # statistics
df.dtypes        # column types
df.shape         # dimensions
df.columns       # column names
```

---

## Data Cleaning

### Missing Data

```python
df.dropna()              # remove rows with NaN
df.fillna(0)             # replace NaN with 0
df.fillna(df.mean())     # replace NaN with mean
```

### Duplicates

```python
df.drop_duplicates()     # remove duplicates
df.duplicated()          # mark duplicates
```

### Strings

```python
df['Name'] = df['Name'].str.strip()   # trim spaces
df['Name'] = df['Name'].str.lower()   # lowercase
```

---

## Filtering & Transformation

```python
df[df['Rating'] <= 5]                      # filter
df['Rating'] = df['Rating'].clip(upper=5)   # limit values
df.rename(columns={'OldName': 'NewName'})   # rename columns
```

Sorting:

```python
df.sort_values(by='Column', ascending=False)
```

---

## Grouping & Aggregation

```python
df.groupby('Category').mean()
df.groupby('Category').agg({'Sales':'sum','Profit':'mean'})
```

*Usage:* Summarize data by categories.

---

## Combining DataFrames

```python
pd.merge(df1, df2, on='ID', how='inner')    # merge on common column
pd.concat([df1, df2], axis=0)               # stack vertically
```

---

## Pivot Tables

```python
df.pivot_table(values='Sales', index='Category', columns='Region', aggfunc='sum')
```

*Usage:* Reshape and summarize data.

---

## Visualization

```python
import matplotlib.pyplot as plt
df['Column'].hist()
df.plot(kind='line', x='Date', y='Sales')
plt.show()
```

*Usage:* Quick plotting from DataFrame.

---

## Scikit-learn Overview

Scikit-learn is a machine learning library for:

* Classification
* Regression
* Clustering
* Dimensionality reduction
* Model selection
* Preprocessing

**Install:**

```bash
pip install scikit-learn
```

---

## Scikit-learn Preprocessing

### Rescaling

```python
from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()
df[['col1', 'col2']] = scaler.fit_transform(df[['col1', 'col2']])
```

*Usage:* Scale values to a range (default 0â€“1).

### Normalization

```python
from sklearn.preprocessing import normalize
df[['col1', 'col2']] = normalize(df[['col1', 'col2']], norm='l2')
```

*Usage:* Scale rows to unit norm.

### Binarization

```python
from sklearn.preprocessing import Binarizer
binarizer = Binarizer(threshold=0.5)
df[['col1']] = binarizer.fit_transform(df[['col1']])
```

*Usage:* Convert values above threshold to 1, else 0.

### Standardization

```python
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
df[['col1', 'col2']] = scaler.fit_transform(df[['col1', 'col2']])
```

*Usage:* Mean=0, variance=1.

### Label Encoding

```python
from sklearn.preprocessing import LabelEncoder
le = LabelEncoder()
df['Category'] = le.fit_transform(df['Category'])
```

*Usage:* Convert labels to integers.

### One-Hot Encoding

```python
from sklearn.preprocessing import OneHotEncoder
ohe = OneHotEncoder(sparse=False)
ohe_data = ohe.fit_transform(df[['Category']])
```

*Usage:* Convert categorical data into binary columns.

---

## Data Imputation

```python
from sklearn.impute import SimpleImputer
imputer = SimpleImputer(missing_values=np.nan, strategy='mean')
df[['col1']] = imputer.fit_transform(df[['col1']])
```

*Usage:* Fill missing values with mean.

---

## EDA (Exploratory Data Analysis)

```python
import seaborn as sns
sns.heatmap(df.corr(), annot=True)
```

*Usage:* Visualize correlations.

---

## Additional Useful Functions

### Checking for Missing Values

```python
data.isnull().sum()
```

*Usage:* Counts missing values in each column.

### Filling Missing Values

```python
data.fillna(0, inplace=True)
```

*Usage:* Replace NaN with a default value.

### Dropping Missing Values

```python
data.dropna(inplace=True)
```

*Usage:* Remove rows containing NaN values.

### Sorting Data

```python
data.sort_values(by='column', ascending=False)
```

*Usage:* Organize data by column(s).

### Grouping and Aggregation

```python
data.groupby('Category').mean()
```

*Usage:* Summarize data by groups.

### Renaming Columns

```python
data.rename(columns={'old': 'new'}, inplace=True)
```

*Usage:* Make column names clearer.

### Resetting Index

```python
data.reset_index(drop=True, inplace=True)
```

*Usage:* Reset index after transformations.

### Setting Index

```python
data.set_index('column_name', inplace=True)
```

*Usage:* Make a specific column the index.

### Value Counts

```python
data['column'].value_counts()
```

*Usage:* View distribution of categorical variables.

### Apply Function

```python
data['column'] = data['column'].apply(lambda x: x * 2)
```

*Usage:* Apply a function element-wise.

### Unique and Nunqiue

```python
data['column'].unique()
data['column'].nunique()
```

*Usage:* Get unique values and counts.

---

## Summary Table

| Function            | Description            |
| ------------------- | ---------------------- |
| `read_csv()`        | Load CSV file          |
| `read_excel()`      | Load Excel file        |
| `head()`            | View first rows        |
| `tail()`            | View last rows         |
| `info()`            | Show structure         |
| `describe()`        | Stats summary          |
| `dropna()`          | Remove NaNs            |
| `fillna()`          | Replace NaNs           |
| `drop_duplicates()` | Remove duplicates      |
| `duplicated()`      | Identify duplicates    |
| `loc[]`             | Label indexing         |
| `iloc[]`            | Positional indexing    |
| `groupby()`         | Group data             |
| `merge()`           | Merge DataFrames       |
| `concat()`          | Concatenate DataFrames |
| `pivot_table()`     | Create pivot table     |
| `apply()`           | Apply function         |
| `sort_values()`     | Sort data              |

---